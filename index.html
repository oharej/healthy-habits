<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçµ Break the Caffeine-Sleep Cycle</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üçµ</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 2em;
        }
        
        .subtitle {
            color: #718096;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .week-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .week-btn {
            padding: 12px 24px;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1em;
            font-weight: 600;
        }
        
        .week-btn:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }
        
        .week-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .goals-section {
            background: #f7fafc;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .goal-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }
        
        .goal-item h3 {
            color: #2d3748;
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        
        .goal-item p {
            color: #4a5568;
            line-height: 1.6;
        }
        
        .tracker-section {
            margin-bottom: 30px;
        }
        
        .tracker-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .day-box {
            aspect-ratio: 1;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }
        
        .day-box:hover {
            transform: scale(1.05);
            border-color: #667eea;
        }
        
        .day-box.completed {
            background: #48bb78;
            border-color: #48bb78;
            color: white;
        }
        
        .day-box.test-day {
            background: #ffd700;
            border-color: #ffa500;
            color: #744210;
            font-weight: bold;
        }
        
        .day-box.test-day.completed {
            background: #48bb78;
            border-color: #2f855a;
            color: white;
        }
        
        .day-label {
            font-size: 0.8em;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .day-number {
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .tips-section {
            background: #fff5f5;
            padding: 25px;
            border-radius: 15px;
            border-left: 4px solid #f56565;
        }
        
        .tips-section h3 {
            color: #c53030;
            margin-bottom: 15px;
        }
        
        .tips-section ul {
            list-style: none;
        }
        
        .tips-section li {
            padding: 10px 0;
            color: #4a5568;
            line-height: 1.6;
            padding-left: 25px;
            position: relative;
        }
        
        .tips-section li:before {
            content: "üí°";
            position: absolute;
            left: 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e2e8f0;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78 0%, #38a169 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid #e2e8f0;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            color: #718096;
            margin-top: 5px;
            font-size: 0.9em;
        }
        
        /* Date Navigation Styles */
        .date-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid #e2e8f0;
        }
        
        .date-nav button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .date-nav button:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }
        
        .date-nav button:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
        }
        
        .current-date {
            text-align: center;
            flex: 1;
        }
        
        .current-date h2 {
            color: #2d3748;
            margin-bottom: 5px;
        }
        
        .current-date p {
            color: #718096;
            font-size: 0.9em;
        }
        
        .today-badge {
            background: #48bb78;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            margin-left: 10px;
            font-weight: 600;
        }
        
        .today-plan {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .today-plan h2 {
            margin-bottom: 15px;
        }
        
        .today-plan h3 {
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .today-plan ul {
            margin-left: 20px;
            line-height: 1.8;
        }

        /* Test Day Styles */
        .test-day-section {
            background: linear-gradient(135deg, #ffd700 0%, #ffa500 100%);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            color: #744210;
        }
        
        .test-day-section h2 {
            margin-bottom: 15px;
        }
        
        .test-input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .test-input-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
        }
        
        .test-input-item label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2d3748;
        }
        
        .test-input-item input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1.1em;
            text-align: center;
        }
        
        .test-input-item input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .save-test-btn {
            background: #48bb78;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s;
        }
        
        .save-test-btn:hover {
            background: #38a169;
            transform: translateY(-2px);
        }
        
        .progress-table {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 20px;
        }
        
        .progress-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .progress-table th {
            background: #f7fafc;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #2d3748;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .progress-table td {
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
            color: #4a5568;
        }
        
        .progress-table tr:last-child td {
            border-bottom: none;
        }
        
        .improvement {
            color: #48bb78;
            font-weight: 600;
        }
        
        .decline {
            color: #f56565;
        }
        
        .pr-badge {
            background: #ffd700;
            color: #744210;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: 600;
            margin-left: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåô Break the Caffeine-Sleep Cycle</h1>
        <p class="subtitle">Your 4-week journey to better sleep and sustainable energy</p>
        
        <!-- Date Navigation -->
        <div class="date-nav">
            <button onclick="changeDay(-1)">‚Üê Previous Day</button>
            <div class="current-date">
                <h2 id="currentDateDisplay">Loading...</h2>
                <p id="dayTypeDisplay">Day 1 of 28</p>
            </div>
            <button onclick="changeDay(1)">Next Day ‚Üí</button>
        </div>
        
        <div style="text-align: center; margin-bottom: 20px;">
            <button onclick="goToToday()" style="background: #48bb78; color: white; border: none; padding: 10px 30px; border-radius: 10px; cursor: pointer; font-weight: 600;">Jump to Today</button>
        </div>
        
        <!-- Today's Plan -->
        <div class="today-plan" id="todayPlan">
            <!-- Today's workout and goals will be inserted here -->
        </div>
        
        <div class="week-selector">
            <button class="week-btn active" onclick="showWeek(1, false)">Week 1</button>
            <button class="week-btn" onclick="showWeek(2, false)">Week 2</button>
            <button class="week-btn" onclick="showWeek(3, false)">Week 3</button>
            <button class="week-btn" onclick="showWeek(4, false)">Week 4</button>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar">0%</div>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="completedDays">0</div>
                <div class="stat-label">Days Completed</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="currentStreak">0</div>
                <div class="stat-label">Current Streak</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="weekProgress">0%</div>
                <div class="stat-label">This Week</div>
            </div>
        </div>
        
        <div id="weekContent"></div>
        
        <div class="tracker-section">
            <h2 style="margin-bottom: 15px;">Daily Tracker - Sleep & Caffeine</h2>
            <div class="tracker-grid" id="trackerGrid"></div>
        </div>
        
        <div class="tracker-section" style="margin-top: 40px;">
            <h2 style="margin-bottom: 15px;">Exercise Tracker - 7-Day Cycles</h2>
            <p style="color: #718096; margin-bottom: 15px;">Each cycle: Test ‚Üí Lower ‚Üí Upper ‚Üí Lower ‚Üí Upper ‚Üí Rest ‚Üí Test. Complete all days! üèÜ</p>
            <div class="tracker-grid" id="exerciseGrid"></div>
        </div>
        
        <!-- Test Day Section -->
        <div class="test-day-section" id="testDaySection">
            <h2>üèÜ Saturday Test Day - Week <span id="testWeekNumber">1</span></h2>
            <p style="margin-bottom: 20px;">Record your max reps/time for each exercise. Track your progress week by week!</p>
            
            <div class="test-input-grid">
                <div class="test-input-item">
                    <label>Push-ups (max reps)</label>
                    <input type="number" id="test-pushups" min="0" placeholder="0">
                </div>
                <div class="test-input-item">
                    <label>Wall Sit (seconds)</label>
                    <input type="number" id="test-wallsit" min="0" placeholder="0">
                </div>
                <div class="test-input-item">
                    <label>Glute Bridges (max reps)</label>
                    <input type="number" id="test-bridges" min="0" placeholder="0">
                </div>
                <div class="test-input-item">
                    <label>Plank (seconds)</label>
                    <input type="number" id="test-plank" min="0" placeholder="0">
                </div>
                <div class="test-input-item">
                    <label>Goblet Squats (max reps)</label>
                    <input type="number" id="test-squats" min="0" placeholder="0">
                </div>
                <div class="test-input-item">
                    <label>Balance - Eyes Closed (avg seconds)</label>
                    <input type="number" id="test-balance" min="0" placeholder="0">
                </div>
            </div>
            
            <button class="save-test-btn" onclick="saveTestResults()">üíæ Save Test Results</button>
            
            <div class="progress-table" id="progressTable">
                <!-- Progress table will be inserted here -->
            </div>
        </div>
        
        <div class="goals-section" style="margin-top: 30px;" id="workoutPlan">
            <!-- Workout plan will be inserted here by JavaScript -->
        </div>
        
        <div class="tips-section">
            <h3>Pro Tips for Success</h3>
            <ul id="weekTips"></ul>
        </div>
    </div>
    
    <script>
        // Migration: Check if user has old data but no start date set
        function migrateOldData() {
            const hasOldData = localStorage.getItem('completedDays') || 
                              localStorage.getItem('exerciseDays') || 
                              localStorage.getItem('testResults');
            
            const hasStartDate = localStorage.getItem('programStartDate');
            
            if (hasOldData && !hasStartDate) {
                // User has old data but no start date - migrate from old fixed date
                const oldStartDate = new Date('2026-02-07T00:00:00');
                localStorage.setItem('programStartDate', oldStartDate.toISOString());
                console.log('Migrated old progress data with start date:', oldStartDate);
                return oldStartDate;
            }
            
            return hasStartDate ? new Date(hasStartDate) : null;
        }
        
        // Date management - Program starts when you do your first test
        let startDate = migrateOldData();
        let currentViewDate = new Date();
        
        // Calculate which day of the program we're on
        function getDayNumber(date) {
            if (!startDate) return 0; // No program started yet
            
            const start = new Date(startDate);
            const current = new Date(date);
            start.setHours(0, 0, 0, 0);
            current.setHours(0, 0, 0, 0);
            
            const diffTime = current - start;
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            return diffDays + 1; // Day 1-based
        }
        
        function getWeekAndDay(dayNumber) {
            // Week is determined by which test cycle we're in (every 7 days)
            const week = Math.ceil(dayNumber / 7);
            const dayOfWeek = ((dayNumber - 1) % 7) + 1;
            return { week: Math.min(week, 4), dayOfWeek };
        }
        
        function setStartDate() {
            // Called when user completes their first test
            if (!startDate) {
                startDate = new Date();
                startDate.setHours(0, 0, 0, 0);
                localStorage.setItem('programStartDate', startDate.toISOString());
                updateDailyView();
                alert('üéâ Program started! Day 1 is today. Come back tomorrow for your first workout!');
            }
        }
        
        function resetProgram() {
            if (confirm('Are you sure you want to reset the program? This will clear your start date and all progress.')) {
                localStorage.removeItem('programStartDate');
                startDate = null;
                updateDailyView();
            }
        }
        
        function changeDay(delta) {
            currentViewDate.setDate(currentViewDate.getDate() + delta);
            updateDailyView();
        }
        
        function goToToday() {
            currentViewDate = new Date();
            updateDailyView();
        }
        
        function updateDailyView() {
            if (!startDate) {
                // Program not started yet
                document.getElementById('currentDateDisplay').innerHTML = 'Program Not Started';
                document.getElementById('dayTypeDisplay').textContent = 'Complete your first test to begin!';
                document.getElementById('todayPlan').innerHTML = `
                    <h2>Welcome! üëã</h2>
                    <p>Ready to start your 4-week transformation? Here's how it works:</p>
                    <ul>
                        <li><strong>Day 1:</strong> Complete your baseline test (scroll down to record results)</li>
                        <li><strong>Days 2-5:</strong> Follow the workout plan</li>
                        <li><strong>Day 6:</strong> Active recovery</li>
                        <li><strong>Day 7:</strong> Test again and see your progress!</li>
                    </ul>
                    <p style="margin-top: 20px;">When you're ready, complete the test below and click "Start Program" to begin!</p>
                    <button onclick="setStartDate()" style="background: #48bb78; color: white; border: none; padding: 15px 40px; border-radius: 10px; cursor: pointer; font-weight: 600; font-size: 1.1em; margin-top: 10px;">üöÄ Start Program</button>
                `;
                return;
            }
            
            const dayNumber = getDayNumber(currentViewDate);
            const { week, dayOfWeek } = getWeekAndDay(dayNumber);
            
            // Update date display
            const dateDisplay = document.getElementById('currentDateDisplay');
            const dayTypeDisplay = document.getElementById('dayTypeDisplay');
            
            const isToday = currentViewDate.toDateString() === new Date().toDateString();
            const todayBadge = isToday ? '<span class="today-badge">TODAY</span>' : '';
            
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            dateDisplay.innerHTML = currentViewDate.toLocaleDateString('en-GB', options) + todayBadge;
            
            if (dayNumber < 1) {
                dayTypeDisplay.textContent = 'Before program start';
            } else if (dayNumber > 28) {
                dayTypeDisplay.textContent = 'Program complete! üéâ';
            } else {
                const dayNames = ['Test Day', 'Lower Body', 'Upper Body', 'Lower Body', 'Upper Body', 'Rest Day', 'Test Day'];
                dayTypeDisplay.textContent = `Day ${dayNumber} - Week ${week}, ${dayNames[dayOfWeek - 1]}`;
            }
            
            // Show today's plan
            renderTodayPlan(week, dayOfWeek, dayNumber);
            
            // Update current week view
            currentWeek = week;
            showWeek(week, true);
        }
        
        function renderTodayPlan(week, dayOfWeek, dayNumber) {
            const planEl = document.getElementById('todayPlan');
            
            if (!startDate) {
                return; // Already handled in updateDailyView
            }
            
            if (dayNumber < 1 || dayNumber > 28) {
                planEl.innerHTML = '<h2>No plan for this date</h2>';
                return;
            }
            
            // Ensure week is valid
            const validWeek = Math.max(1, Math.min(4, week));
            const weekData = weeks[validWeek];
            const workoutData = workouts[validWeek];
            
            if (!weekData || !workoutData) {
                planEl.innerHTML = '<h2>Week data not found</h2>';
                console.error('Missing data for week:', validWeek);
                return;
            }
            
            let workoutType = '';
            let workoutPlan = '';
            
            // New cycle structure: Day 1 = Test, 2 = Lower, 3 = Upper, 4 = Lower, 5 = Upper, 6 = Rest, 7 = Test
            if (dayOfWeek === 1 || dayOfWeek === 7) {
                // Test days
                const testNumber = Math.floor((dayNumber + 6) / 7); // Which test this is (1, 2, 3, 4)
                workoutType = dayOfWeek === 1 ? 'üèÜ TEST DAY - Baseline' : `üèÜ TEST DAY - Week ${validWeek} Progress Check`;
                workoutPlan = `
                    <h3>Today's Mission: ${dayOfWeek === 1 ? 'Establish Your Baseline!' : 'Test Your Progress!'}</h3>
                    <p>Perform max reps/time for each test exercise and record your results below.</p>
                    <ul>
                        <li>Push-ups (max reps)</li>
                        <li>Wall Sit (max seconds)</li>
                        <li>Glute Bridges (max reps)</li>
                        <li>Plank Hold (max seconds)</li>
                        <li>Goblet Squats (max reps)</li>
                        <li>Balance - Eyes Closed (avg seconds)</li>
                    </ul>
                `;
            } else if (dayOfWeek === 2 || dayOfWeek === 4) {
                // Lower body days
                workoutType = 'üí™ LOWER BODY';
                const exercises = workoutData.lower.exercises.map(ex => 
                    `<li><strong>${ex.name}</strong> - ${ex.reps}</li>`
                ).join('');
                workoutPlan = `
                    <h3>${workoutData.lower.title}</h3>
                    <p><strong>Warm-up:</strong> ${workoutData.lower.warmup}</p>
                    <p><strong>Circuit:</strong> ${workoutData.lower.circuit}</p>
                    <ul>${exercises}</ul>
                    <p><strong>Cool-down:</strong> ${workoutData.lower.cooldown}</p>
                `;
            } else if (dayOfWeek === 3 || dayOfWeek === 5) {
                // Upper body days
                workoutType = 'üí™ UPPER BODY';
                const exercises = workoutData.upper.exercises.map(ex => 
                    `<li><strong>${ex.name}</strong> - ${ex.reps}</li>`
                ).join('');
                workoutPlan = `
                    <h3>${workoutData.upper.title}</h3>
                    <p><strong>Warm-up:</strong> ${workoutData.upper.warmup}</p>
                    <p><strong>Circuit:</strong> ${workoutData.upper.circuit}</p>
                    <ul>${exercises}</ul>
                    <p><strong>Cool-down:</strong> ${workoutData.upper.cooldown}</p>
                `;
            } else if (dayOfWeek === 6) {
                // Rest day
                workoutType = 'üßò ACTIVE RECOVERY';
                const exercises = workoutData.recovery.exercises.map(ex => 
                    `<li><strong>${ex.name}</strong> - ${ex.reps}: ${ex.notes}</li>`
                ).join('');
                workoutPlan = `
                    <h3>${workoutData.recovery.title}</h3>
                    <ul>${exercises}</ul>
                `;
            }
            
            const goals = weekData.goals.map(g => 
                `<li><strong>${g.title.split(' ')[0]}</strong> ${g.text}</li>`
            ).join('');
            
            planEl.innerHTML = `
                <h2>${workoutType}</h2>
                ${workoutPlan}
                <h3 style="margin-top: 25px;">Week ${validWeek} Habits</h3>
                <ul>${goals}</ul>
                <button onclick="resetProgram()" style="background: #f56565; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 0.9em; margin-top: 15px;">Reset Program</button>
            `;
        }
        
        const testExercises = [
            { id: 'pushups', name: 'Push-ups', unit: 'reps' },
            { id: 'wallsit', name: 'Wall Sit', unit: 'sec' },
            { id: 'bridges', name: 'Glute Bridges', unit: 'reps' },
            { id: 'plank', name: 'Plank Hold', unit: 'sec' },
            { id: 'squats', name: 'Goblet Squats', unit: 'reps' },
            { id: 'balance', name: 'Balance (eyes closed)', unit: 'sec' }
        ];
        
        const workouts = {
            1: {
                title: "Week 1: Building the Foundation",
                schedule: "TEST ‚Üí Lower ‚Üí Upper ‚Üí Lower ‚Üí Upper ‚Üí Rest ‚Üí TEST",
                lower: {
                    title: "LOWER BODY - Knee Rehab Focus",
                    warmup: "üèãÔ∏è Warm-up (5 mins): Cat-cow (10) ‚Ä¢ Ankle circles (10 each) ‚Ä¢ Leg swings (10 each) ‚Ä¢ Hip circles (10 each)",
                    circuit: "3 rounds ‚Ä¢ 60 sec rest",
                    exercises: [
                        { name: "Glute Bridges", reps: "15 reps", notes: "2 second hold at top. Feel the glute squeeze!" },
                        { name: "Clamshells", reps: "15 each side", notes: "Control the movement. Hip should burn." },
                        { name: "KB Deadlifts", reps: "12 reps", notes: "Push hips back, chest proud. Feel hamstrings." },
                        { name: "Wall Sits", reps: "30 seconds", notes: "Back flat. Thighs parallel to ground." },
                        { name: "Reverse Lunges", reps: "10 each side", notes: "Step back, controlled descent. No KB yet." },
                        { name: "Goblet Squats", reps: "10 reps", notes: "Half depth. KB at chest. Knees track over toes." }
                    ],
                    cooldown: "üßò Cool-down (5 mins): Figure-4 (30s each) ‚Ä¢ Quad stretch (30s each) ‚Ä¢ Hamstring stretch (30s each) ‚Ä¢ Child's pose (60s)"
                },
                upper: {
                    title: "UPPER BODY - KB & Bodyweight",
                    warmup: "üèãÔ∏è Warm-up (5 mins): Arm circles (10 each way) ‚Ä¢ Shoulder rolls (10) ‚Ä¢ Cat-cow (10) ‚Ä¢ Wrist circles (10 each)",
                    circuit: "3 rounds ‚Ä¢ 45 sec rest",
                    exercises: [
                        { name: "KB Floor Press", reps: "12 reps", notes: "Lying on mat. Press KB up with both hands on handle." },
                        { name: "KB Rows (each arm)", reps: "12 each side", notes: "Hand on mat for support. Pull KB to hip." },
                        { name: "Push-ups (modified OK)", reps: "10 reps", notes: "Knees down is fine! Full range of motion." },
                        { name: "KB Overhead Press", reps: "10 reps", notes: "Both hands on KB. Press overhead, control down." },
                        { name: "Plank Hold", reps: "30 seconds", notes: "Straight line. Squeeze glutes. Breathe!" },
                        { name: "KB Halos", reps: "10 each direction", notes: "Circle KB around head. Keeps shoulders healthy." }
                    ],
                    cooldown: "üßò Cool-down (5 mins): Thread the needle (30s each) ‚Ä¢ Chest stretch (30s each) ‚Ä¢ Tricep stretch (30s each) ‚Ä¢ Child's pose (60s)"
                },
                recovery: {
                    title: "ACTIVE RECOVERY DAY",
                    exercises: [
                        { name: "Gentle yoga or stretching", reps: "20-30 mins", notes: "Focus on areas that feel tight" },
                        { name: "Easy walk", reps: "20-30 mins", notes: "Just move. No intensity." },
                        { name: "Foam rolling", reps: "10-15 mins", notes: "Hit quads, glutes, upper back if you have a roller" }
                    ]
                }
            },
            2: {
                title: "Week 2: Adding Intensity",
                schedule: "TEST ‚Üí Lower ‚Üí Upper ‚Üí Lower ‚Üí Upper ‚Üí Rest ‚Üí TEST",
                lower: {
                    title: "LOWER BODY - Progression",
                    warmup: "üèãÔ∏è Warm-up (5 mins): Cat-cow (10) ‚Ä¢ Ankle circles (10 each) ‚Ä¢ Dynamic leg swings all directions (10 each) ‚Ä¢ Hip circles (10 each) ‚Ä¢ 10 bodyweight squats",
                    circuit: "4 rounds ‚Ä¢ 60 sec rest",
                    exercises: [
                        { name: "Single-leg Glute Bridges", reps: "12 each side", notes: "Other leg extended. Keep hips level!" },
                        { name: "Clamshells with KB on hip", reps: "15 each side", notes: "Add weight! Control is everything." },
                        { name: "Single-leg KB Deadlifts", reps: "8 each side", notes: "Kickstand stance (back toe down for balance)." },
                        { name: "Wall Sits", reps: "40 seconds", notes: "Last 10 seconds add small pulses." },
                        { name: "KB Reverse Lunges", reps: "10 each side", notes: "KB at chest. Focus on balance." },
                        { name: "Goblet Squats", reps: "12 reps", notes: "Go deeper if knee allows. 3-2-1 tempo down." }
                    ],
                    cooldown: "üßò Cool-down (5 mins): Figure-4 (40s each) ‚Ä¢ Quad stretch (40s each) ‚Ä¢ Hamstring stretch (40s each) ‚Ä¢ Pigeon pose (30s each)"
                },
                upper: {
                    title: "UPPER BODY - Level Up",
                    warmup: "üèãÔ∏è Warm-up (5 mins): Arm circles (10 each) ‚Ä¢ Shoulder rolls (10) ‚Ä¢ 10 light push-ups ‚Ä¢ Wrist circles (10 each)",
                    circuit: "4 rounds ‚Ä¢ 45 sec rest",
                    exercises: [
                        { name: "KB Floor Press", reps: "15 reps", notes: "Controlled tempo. Pause at bottom." },
                        { name: "KB Rows (each arm)", reps: "15 each side", notes: "Pull elbow high. Squeeze shoulder blade." },
                        { name: "Push-ups", reps: "12 reps", notes: "Try standard if you can. Slow down." },
                        { name: "KB Overhead Press", reps: "12 reps", notes: "Engage core. Don't arch back." },
                        { name: "Plank Hold", reps: "40 seconds", notes: "Add shoulder taps if it's too easy (5 each)." },
                        { name: "KB Halos + Overhead Hold", reps: "8 each + 10s hold", notes: "Circle then hold KB overhead. Shoulder stability!" }
                    ],
                    cooldown: "üßò Cool-down (5 mins): Thread the needle (40s each) ‚Ä¢ Doorway chest stretch (40s each) ‚Ä¢ Tricep stretch (40s each)"
                },
                recovery: {
                    title: "ACTIVE RECOVERY DAY",
                    exercises: [
                        { name: "Yoga flow", reps: "30 mins", notes: "Sun salutations, downward dogs, warrior poses" },
                        { name: "Walk or light bike", reps: "30 mins", notes: "Conversational pace only" },
                        { name: "Full body stretch routine", reps: "15 mins", notes: "Hit everything that's sore" }
                    ]
                }
            },
            3: {
                title: "Week 3: Building Strength",
                schedule: "TEST ‚Üí Lower ‚Üí Upper ‚Üí Lower ‚Üí Upper ‚Üí Rest ‚Üí TEST",
                lower: {
                    title: "LOWER BODY - Getting Strong",
                    warmup: "üèãÔ∏è Warm-up (6 mins): Full mobility flow + 10 squats + 5 lunges each side",
                    circuit: "4 rounds ‚Ä¢ 50 sec rest",
                    exercises: [
                        { name: "Single-leg Glute Bridges", reps: "15 each + 3s hold", notes: "Maximum glute contraction. Squeeze hard!" },
                        { name: "Lateral Band Walks", reps: "15 steps each way", notes: "Use resistance band or KB for resistance in quarter squat." },
                        { name: "Single-leg KB Deadlifts", reps: "10 each side", notes: "Float back leg higher. Feel the balance challenge." },
                        { name: "Bulgarian Split Squats", reps: "10 each side", notes: "Back foot elevated on mat roll. KB at chest." },
                        { name: "Goblet Squats - Pause", reps: "12 reps", notes: "3 second pause at bottom. Full depth if knee is happy!" },
                        { name: "Jump Squats (light)", reps: "8 reps", notes: "Only if knee feels 100%. Quarter squat, soft landing." }
                    ],
                    cooldown: "üßò Cool-down (6 mins): Deep stretching + pigeon pose both sides"
                },
                upper: {
                    title: "UPPER BODY - Max Effort",
                    warmup: "üèãÔ∏è Warm-up (6 mins): Dynamic arm swings + 10 push-ups + shoulder mobility",
                    circuit: "4 rounds ‚Ä¢ 40 sec rest",
                    exercises: [
                        { name: "KB Floor Press - Slow", reps: "15 reps", notes: "4 seconds down, explosive up. Feel the tension." },
                        { name: "KB Rows (each arm)", reps: "15 each", notes: "Add pause at top. Pull high to armpit." },
                        { name: "Push-up Variations", reps: "15 reps", notes: "Mix: 5 wide, 5 standard, 5 diamond. Challenge yourself." },
                        { name: "KB Overhead Press", reps: "15 reps", notes: "Stand on one leg to add core challenge (switch halfway)." },
                        { name: "Plank to Down Dog", reps: "10 reps", notes: "Plank position, push hips back to downward dog, return." },
                        { name: "KB Windmills", reps: "8 each side", notes: "KB overhead, bend sideways. Advanced shoulder work!" }
                    ],
                    cooldown: "üßò Cool-down (6 mins): Deep shoulder and chest stretches"
                },
                recovery: {
                    title: "ACTIVE RECOVERY DAY",
                    exercises: [
                        { name: "Long walk", reps: "45-60 mins", notes: "Get outside. Enjoy it." },
                        { name: "Full yoga session", reps: "30-40 mins", notes: "YouTube a flow class" },
                        { name: "Mobility work", reps: "20 mins", notes: "Focus on hips and shoulders" }
                    ]
                }
            },
            4: {
                title: "Week 4: Peak Performance",
                schedule: "TEST ‚Üí Lower ‚Üí Upper ‚Üí Lower ‚Üí Upper ‚Üí Rest ‚Üí TEST",
                lower: {
                    title: "LOWER BODY - Beast Mode",
                    warmup: "üèãÔ∏è Warm-up (6 mins): Full dynamic warm-up + activation exercises",
                    circuit: "5 rounds ‚Ä¢ 45 sec rest",
                    exercises: [
                        { name: "Single-leg Glute Bridges", reps: "20 each + 5s hold", notes: "Add KB on hips for extra resistance if you want!" },
                        { name: "Cossack Squats", reps: "10 each side", notes: "Wide stance, shift weight side to side. Advanced!" },
                        { name: "Single-leg KB Deadlifts", reps: "12 each", notes: "Full extension. Back leg straight out. Balance master." },
                        { name: "Bulgarian Split Squats", reps: "12 each + 3s pause", notes: "Pause at bottom. This will burn!" },
                        { name: "Goblet Squats - Full Depth", reps: "15 reps", notes: "As deep as comfortable. Slow and controlled." },
                        { name: "KB Swings", reps: "15 reps", notes: "Hip hinge power! Swing to shoulder height. Only if knee feels great." }
                    ],
                    cooldown: "üßò Cool-down (6 mins): Deep stretching, celebrate your strength!"
                },
                upper: {
                    title: "UPPER BODY - Maximum Strength",
                    warmup: "üèãÔ∏è Warm-up (6 mins): Full upper body mobility + light activation",
                    circuit: "5 rounds ‚Ä¢ 40 sec rest",
                    exercises: [
                        { name: "KB Floor Press", reps: "20 reps", notes: "You're strong now! Push yourself." },
                        { name: "KB Rows", reps: "18 each", notes: "Perfect form. Control the eccentric." },
                        { name: "Push-ups - Advanced", reps: "15-20 reps", notes: "Decline on mat roll, archer push-ups, or standard done right." },
                        { name: "KB Overhead Press", reps: "15 reps", notes: "Standing. Engage everything. Full ROM." },
                        { name: "Plank Series", reps: "60 seconds total", notes: "20s hold, 10s shoulder taps, 20s hold, 10s hip dips." },
                        { name: "KB Turkish Get-Up", reps: "3 each side", notes: "Slow, controlled, full body movement. YouTube the form!" }
                    ],
                    cooldown: "üßò Cool-down (6 mins): Full body stretch, you earned this!"
                },
                recovery: {
                    title: "ACTIVE RECOVERY DAY - Reflect & Recover",
                    exercises: [
                        { name: "Your choice of movement", reps: "30-60 mins", notes: "Walk, yoga, swim, bike - whatever feels good" },
                        { name: "Reflect on progress", reps: "10 mins", notes: "How much stronger do you feel vs Week 1?" },
                        { name: "Plan Week 5+", reps: "", notes: "Repeat Week 4 or design your own progression!" }
                    ]
                }
            }
        };
        
        const weeks = {
            1: {
                title: "Week 1: Awareness & Small Cuts",
                goals: [
                    {
                        title: "‚òï Caffeine Goal",
                        text: "Cut down to 5-6 cups of tea maximum. No tea after 3pm."
                    },
                    {
                        title: "üõèÔ∏è Sleep Goal",
                        text: "Aim for bed by 12:30am (30 mins earlier). Set a 12:00am 'wind down' alarm."
                    },
                    {
                        title: "‚è∞ Wake Goal",
                        text: "Try to wake at 8:30am consistently (pick one time, even on weekends)"
                    }
                ],
                tips: [
                    "Track every cup of tea you drink - awareness is half the battle",
                    "Replace late afternoon tea with herbal tea or water",
                    "Put your phone on charge outside your bedroom at midnight",
                    "If you slip up, don't restart - just get back on track the next day"
                ]
            },
            2: {
                title: "Week 2: Building Momentum",
                goals: [
                    {
                        title: "‚òï Caffeine Goal",
                        text: "Reduce to 4-5 cups of tea. No tea after 2pm."
                    },
                    {
                        title: "üõèÔ∏è Sleep Goal",
                        text: "Bed by midnight. Start a 20-minute wind-down routine at 11:40pm."
                    },
                    {
                        title: "‚è∞ Wake Goal",
                        text: "Wake at 8am consistently. Use an alarm, and get up when it rings."
                    }
                ],
                tips: [
                    "You might feel tired this week - that's your body adjusting. Power through!",
                    "Try a short 10-minute walk in the morning to wake up naturally",
                    "Keep decaf tea or herbal options handy for afternoon cravings",
                    "If you're struggling with the cutoff time, dilute your last cup of tea"
                ]
            },
            3: {
                title: "Week 3: The Sweet Spot",
                goals: [
                    {
                        title: "‚òï Caffeine Goal",
                        text: "Down to 3-4 cups of tea. No tea after 1pm."
                    },
                    {
                        title: "üõèÔ∏è Sleep Goal",
                        text: "Bed by 11:30pm. Wind down routine starts at 11:10pm."
                    },
                    {
                        title: "‚è∞ Wake Goal",
                        text: "Wake at 7:30am. You should be getting 8 hours now!"
                    }
                ],
                tips: [
                    "You should start feeling better rested - notice the difference!",
                    "Celebrate your progress! You've made real changes.",
                    "Front-load your tea - have most of it before noon",
                    "If you need an afternoon boost, try a 15-minute power nap instead"
                ]
            },
            4: {
                title: "Week 4: Sustainable Habits",
                goals: [
                    {
                        title: "‚òï Caffeine Goal",
                        text: "2-3 cups of tea, all before noon. This is your sustainable level!"
                    },
                    {
                        title: "üõèÔ∏è Sleep Goal",
                        text: "Bed by 11pm. You're a morning person now!"
                    },
                    {
                        title: "‚è∞ Wake Goal",
                        text: "Wake at 7am feeling actually refreshed."
                    }
                ],
                tips: [
                    "This is your new normal - you've broken the cycle!",
                    "Plan how you'll maintain this when life gets chaotic",
                    "You can have flexibility, but keep the caffeine cutoff sacred",
                    "Share what worked with someone else trying to improve their habits"
                ]
            }
        };
        
        let currentWeek = 1;
        let completedDays = JSON.parse(localStorage.getItem('completedDays') || '{}');
        let exerciseDays = JSON.parse(localStorage.getItem('exerciseDays') || '{}');
        let testResults = JSON.parse(localStorage.getItem('testResults') || '{}');
        
        function showWeek(week, skipDateUpdate = false) {
            currentWeek = week;
            document.querySelectorAll('.week-btn').forEach(btn => btn.classList.remove('active'));
            const buttons = document.querySelectorAll('.week-btn');
            if (buttons[week - 1]) buttons[week - 1].classList.add('active');
            
            const weekData = weeks[week];
            const content = document.getElementById('weekContent');
            
            let goalsHTML = '<div class="goals-section"><h2 style="margin-bottom: 20px;">This Week\'s Goals</h2>';
            weekData.goals.forEach(goal => {
                goalsHTML += `
                    <div class="goal-item">
                        <h3>${goal.title}</h3>
                        <p>${goal.text}</p>
                    </div>
                `;
            });
            goalsHTML += '</div>';
            
            content.innerHTML = goalsHTML;
            
            const tipsEl = document.getElementById('weekTips');
            tipsEl.innerHTML = weekData.tips.map(tip => `<li>${tip}</li>`).join('');
            
            renderTracker();
            renderExerciseTracker();
            renderWorkoutPlan();
            updateStats();
            checkTestDay();
        }
        
        function renderTracker() {
            const grid = document.getElementById('trackerGrid');
            const days = ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'];
            
            grid.innerHTML = days.map((day, index) => {
                const dayKey = `week${currentWeek}-day${index + 1}`;
                const isCompleted = completedDays[dayKey];
                
                return `
                    <div class="day-box ${isCompleted ? 'completed' : ''}" onclick="toggleDay('${dayKey}')">
                        <div class="day-label">${day}</div>
                        <div class="day-number">${index + 1}</div>
                    </div>
                `;
            }).join('');
        }
        
        function toggleDay(dayKey) {
            if (completedDays[dayKey]) {
                delete completedDays[dayKey];
            } else {
                completedDays[dayKey] = true;
            }
            localStorage.setItem('completedDays', JSON.stringify(completedDays));
            renderTracker();
            updateStats();
        }
        
        function renderExerciseTracker() {
            const grid = document.getElementById('exerciseGrid');
            const days = ['Test', 'Lower', 'Upper', 'Lower', 'Upper', 'Rest', 'Test'];
            
            grid.innerHTML = days.map((day, index) => {
                const dayKey = `week${currentWeek}-exercise${index + 1}`;
                const isCompleted = exerciseDays[dayKey];
                const isTestDay = index === 0 || index === 6;
                
                return `
                    <div class="day-box ${isTestDay ? 'test-day' : ''} ${isCompleted ? 'completed' : ''}" onclick="toggleExercise('${dayKey}', ${isTestDay})">
                        <div class="day-label">${day}${isTestDay ? ' üèÜ' : ''}</div>
                        <div class="day-number">${index + 1}</div>
                    </div>
                `;
            }).join('');
        }
        
        function toggleExercise(dayKey, isTestDay) {
            if (exerciseDays[dayKey]) {
                delete exerciseDays[dayKey];
            } else {
                exerciseDays[dayKey] = true;
            }
            localStorage.setItem('exerciseDays', JSON.stringify(exerciseDays));
            renderExerciseTracker();
        }
        
        function checkTestDay() {
            // Update the week number in test section
            document.getElementById('testWeekNumber').textContent = currentWeek;
            
            // Load existing test results for this week if they exist
            const weekKey = `week${currentWeek}`;
            if (testResults[weekKey]) {
                const results = testResults[weekKey];
                document.getElementById('test-pushups').value = results.pushups || '';
                document.getElementById('test-wallsit').value = results.wallsit || '';
                document.getElementById('test-bridges').value = results.bridges || '';
                document.getElementById('test-plank').value = results.plank || '';
                document.getElementById('test-squats').value = results.squats || '';
                document.getElementById('test-balance').value = results.balance || '';
            } else {
                // Clear inputs for new week
                document.getElementById('test-pushups').value = '';
                document.getElementById('test-wallsit').value = '';
                document.getElementById('test-bridges').value = '';
                document.getElementById('test-plank').value = '';
                document.getElementById('test-squats').value = '';
                document.getElementById('test-balance').value = '';
            }
            
            renderProgressTable();
        }
        
        function saveTestResults() {
            const weekKey = `week${currentWeek}`;
            testResults[weekKey] = {
                pushups: parseInt(document.getElementById('test-pushups').value) || 0,
                wallsit: parseInt(document.getElementById('test-wallsit').value) || 0,
                bridges: parseInt(document.getElementById('test-bridges').value) || 0,
                plank: parseInt(document.getElementById('test-plank').value) || 0,
                squats: parseInt(document.getElementById('test-squats').value) || 0,
                balance: parseInt(document.getElementById('test-balance').value) || 0
            };
            
            localStorage.setItem('testResults', JSON.stringify(testResults));
            renderProgressTable();
            alert('‚úÖ Test results saved! Keep crushing it!');
        }
        
        function renderProgressTable() {
            const tableContainer = document.getElementById('progressTable');
            
            if (Object.keys(testResults).length === 0) {
                tableContainer.innerHTML = '<p style="text-align: center; padding: 20px; color: #744210;">Complete your first test to see progress tracking!</p>';
                return;
            }
            
            let tableHTML = '<table><thead><tr><th>Exercise</th>';
            
            // Add column headers for each week that has data
            for (let w = 1; w <= 4; w++) {
                if (testResults[`week${w}`]) {
                    tableHTML += `<th>Week ${w}</th>`;
                }
            }
            tableHTML += '<th>Change</th></tr></thead><tbody>';
            
            // Add rows for each exercise
            testExercises.forEach(exercise => {
                tableHTML += `<tr><td><strong>${exercise.name}</strong></td>`;
                
                let values = [];
                for (let w = 1; w <= 4; w++) {
                    const weekKey = `week${w}`;
                    if (testResults[weekKey]) {
                        const val = testResults[weekKey][exercise.id];
                        values.push(val);
                        
                        // Check if this is a personal record
                        const isPR = val > 0 && values.every(v => val >= v);
                        const prBadge = isPR && values.length > 1 ? '<span class="pr-badge">PR</span>' : '';
                        
                        tableHTML += `<td>${val} ${exercise.unit}${prBadge}</td>`;
                    }
                }
                
                // Calculate improvement
                if (values.length > 1) {
                    const first = values[0];
                    const last = values[values.length - 1];
                    const change = last - first;
                    const percent = first > 0 ? Math.round((change / first) * 100) : 0;
                    const changeClass = change > 0 ? 'improvement' : (change < 0 ? 'decline' : '');
                    const arrow = change > 0 ? '‚Üë' : (change < 0 ? '‚Üì' : '‚Üí');
                    tableHTML += `<td class="${changeClass}">${arrow} ${change > 0 ? '+' : ''}${change} (${percent > 0 ? '+' : ''}${percent}%)</td>`;
                } else {
                    tableHTML += '<td>-</td>';
                }
                
                tableHTML += '</tr>';
            });
            
            tableHTML += '</tbody></table>';
            tableContainer.innerHTML = tableHTML;
        }
        
        function renderWorkoutPlan() {
            const workout = workouts[currentWeek];
            const planEl = document.getElementById('workoutPlan');
            
            let lowerHTML = '';
            workout.lower.exercises.forEach((ex, i) => {
                lowerHTML += `<strong>${i + 1}. ${ex.name}</strong> (${ex.reps})<br>${ex.notes}<br><br>`;
            });
            
            let upperHTML = '';
            workout.upper.exercises.forEach((ex, i) => {
                upperHTML += `<strong>${i + 1}. ${ex.name}</strong> (${ex.reps})<br>${ex.notes}<br><br>`;
            });
            
            let recoveryHTML = '';
            workout.recovery.exercises.forEach((ex, i) => {
                recoveryHTML += `<strong>${i + 1}. ${ex.name}</strong> (${ex.reps})<br>${ex.notes}<br><br>`;
            });
            
            planEl.innerHTML = `
                <h2 style="margin-bottom: 10px;">${workout.title}</h2>
                <p style="color: #718096; margin-bottom: 25px; font-size: 1.1em;"><strong>Weekly Schedule:</strong> ${workout.schedule}</p>
                
                <div class="goal-item" style="border-left-color: #ffa500; background: #fffaf0;">
                    <h3>üèÜ DAY 1 & 7 - TEST DAYS</h3>
                    <p><em>Start and end each cycle with progress testing!</em></p>
                    <p style="margin-top: 15px;">Perform max reps/time for: Push-ups, Wall Sit, Glute Bridges, Plank, Goblet Squats, and Balance (eyes closed). Record results to track your gains!</p>
                </div>
                
                <div class="goal-item" style="border-left-color: #48bb78;">
                    <h3>üí™ ${workout.lower.title}</h3>
                    <p><em>Days 2 & 4 - 2x per week lower body</em></p>
                    <p style="margin-top: 15px;"><strong>Warm-up:</strong> ${workout.lower.warmup}</p>
                    <p style="margin-top: 10px;"><strong>Workout:</strong> ${workout.lower.circuit}</p>
                    <p style="margin-top: 15px;">${lowerHTML}</p>
                    <p><strong>Cool-down:</strong> ${workout.lower.cooldown}</p>
                </div>
                
                <div class="goal-item" style="border-left-color: #667eea;">
                    <h3>üí™ ${workout.upper.title}</h3>
                    <p><em>Days 3 & 5 - 2x per week upper body</em></p>
                    <p style="margin-top: 15px;"><strong>Warm-up:</strong> ${workout.upper.warmup}</p>
                    <p style="margin-top: 10px;"><strong>Workout:</strong> ${workout.upper.circuit}</p>
                    <p style="margin-top: 15px;">${upperHTML}</p>
                    <p><strong>Cool-down:</strong> ${workout.upper.cooldown}</p>
                </div>
                
                <div class="goal-item" style="border-left-color: #ed8936;">
                    <h3>üßò ${workout.recovery.title}</h3>
                    <p><em>Day 6 - Let your body repair!</em></p>
                    <p style="margin-top: 15px;">${recoveryHTML}</p>
                </div>
                
                <div class="goal-item" style="border-left-color: #f56565; background: #fff5f5;">
                    <h3>‚ö†Ô∏è Training Smart</h3>
                    <p>‚Ä¢ <strong>Knee pain?</strong> Sharp pain = stop immediately. Dull burn = normal muscle fatigue<br>
                    ‚Ä¢ <strong>Form over reps:</strong> Better to do 8 perfect reps than 15 sloppy ones<br>
                    ‚Ä¢ <strong>Listen to your body:</strong> Sore is OK. Injured is not. Take an extra rest day if needed<br>
                    ‚Ä¢ <strong>Fuel properly:</strong> Eat enough protein and sleep well - that's when you get stronger<br>
                    ‚Ä¢ <strong>Progressive overload:</strong> Only move to next week when current week feels manageable</p>
                </div>
            `;
        }
        
        function updateStats() {
            const total = Object.keys(completedDays).length;
            document.getElementById('completedDays').textContent = total;
            
            const weekKeys = Array.from({length: 7}, (_, i) => `week${currentWeek}-day${i + 1}`);
            const weekCompleted = weekKeys.filter(key => completedDays[key]).length;
            document.getElementById('weekProgress').textContent = Math.round((weekCompleted / 7) * 100) + '%';
            
            let streak = 0;
            for (let w = 1; w <= 4; w++) {
                for (let d = 1; d <= 7; d++) {
                    if (completedDays[`week${w}-day${d}`]) {
                        streak++;
                    } else if (w < currentWeek || (w === currentWeek && d <= new Date().getDay())) {
                        streak = 0;
                    }
                }
            }
            document.getElementById('currentStreak').textContent = streak;
            
            const totalPossible = 28;
            const percentage = Math.round((total / totalPossible) * 100);
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = percentage + '%';
            progressBar.textContent = percentage + '%';
        }
        
        // Initialize app
        updateDailyView();
        renderExerciseTracker();
    </script>
</body>
</html>